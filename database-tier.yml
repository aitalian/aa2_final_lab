---
# Only use in-memory inventory when not running in Tower
- import_playbook: in-memory-inventory.yml
  when: awx_job_id is not defined

- name: "Deploy, configure, and populate PostgreSQL 12"
  hosts: database_servers
  become: true
  gather_facts: false
  tags:
    - database_servers
  vars:
    postgres_users:
      - name: flask
        password: redhat
        database: flask_db
        state: present
        priv: ALL
    postgres_databases:
      - name: flask_db
        owner: flask
      - name: books_store
        owner: flask
  roles:
    - postgresql_install
